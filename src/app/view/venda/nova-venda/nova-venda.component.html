<div class="main-content">
    <div class="container-fluid">
        <div class="card">
            <div class="card-body">
                <div class="row mb-2">
                    <h3 class="m-0 ml-2"> <b>Nova Venda</b></h3>
                </div>
                <form [formGroup]="formVenda">
                    <div class="row">
                        <div class="col-md-12">
                            <mat-form-field class="example-full-width">
                                <mat-label>Cliente</mat-label>
                                <mat-select formControlName="cliente">
                                  <mat-option *ngFor="let cli of listaClientes" [value]="cli.key">
                                    {{cli.cliente.nome}}
                                  </mat-option>
                                </mat-select>
                              </mat-form-field>
                        </div>

                        <div class="col-md-7">
                            <mat-form-field class="example-full-width">
                                <mat-label>Produto</mat-label>
                                <mat-select formControlName="produto">
                                  <mat-option *ngFor="let cli of listaProdutos" [value]="cli.key">
                                    {{cli.produto.nome}} - ({{cli.produto.valor | currency:'BRL'}})
                                  </mat-option>
                                </mat-select>
                              </mat-form-field>
                        </div>
                        
                        <div class="col-md-2">
                            <mat-form-field class="example-full-width">
                                <input matInput placeholder="Quantidade" type="text" (blur)="sumValor($event.target.value)" formControlName="qtd">
                            </mat-form-field>
                        </div>

                        <div class="col-md-2">
                            <mat-form-field class="example-full-width">
                                <input matInput placeholder="Valor" type="text" formControlName="valor" currencyMask [options]="{ prefix: 'R$ ', thousands: '.', decimal: ',' }">
                            </mat-form-field>
                        </div>

                        <div class="col-md-1">
                            <button mat-mini-fab color="primary" (click)="addProduto()" #tooltip="matTooltip" matTooltip="Adicionar Produto">
                                <mat-icon >add_shopping_cart</mat-icon>
                              </button>
                        </div>

                    </div>

                    <div class="row table-responsive">
                        <table class="table" style="white-space: nowrap;">
                            <thead class=" text-primary">
                                <th> Produto </th>
                                <th class="text-right"> Quantidade </th>
                                <th class="text-right"> Valor Unit√°rio </th>
                                <th class="text-right"> Total </th>
                            </thead>
                            <tbody>
                                <tr *ngFor="let item of produtoSelecionado">
                                    <td> {{item.produto}}</td>
                                    <td class="text-right"> {{item.qtde}}</td>
                                    <td class="text-right"> {{item.valor | currency: 'BRL'}}</td>
                                    <td class="text-right"> {{item.total | currency: 'BRL'}}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="row">
                        <div class="col-md-12 text-right">
                            <a mat-raised-button color="default" [routerLink]="['/view/venda']">Cancelar</a>
                            <button class="btn btn-success ml-2" (click)="salvar()" [disabled]="produtoSelecionado.length <= 0"> Salvar </button>
                        </div>

                    </div>
                </form>

                
            </div>
        </div>
    </div>
</div>